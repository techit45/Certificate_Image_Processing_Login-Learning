# ЁЯзк р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ Step-by-Step

## ЁЯОп **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╕Чр╕Фр╕кр╕нр╕Ъ Google Apps Script**

### 1.1 р╕нр╕▒р╕Ыр╣Ар╕Фр╕Х Google Apps Script
1. р╣Ар╕Ыр╕┤р╕Ф: https://script.google.com/d/AKfycbzGNFHGy8WBSbxZpxC_QWAyzCTjlnCCQsGItBIJk-f40k0jtsMx7nlteNr7WOUhQeOU/edit
2. р╕Др╕▒р╕Фр╕ер╕нр╕Бр╣Вр╕Др╣Йр╕Фр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Фр╕Ир╕▓р╕Б `google-apps-script.js` 
3. р╕зр╕▓р╕Зр╕Чр╕▒р╕Ър╣Вр╕Др╣Йр╕Фр╣Ар╕Фр╕┤р╕б
4. р╕Бр╕Ф **Ctrl+S** р╣Ар╕Юр╕╖р╣Ир╕нр╕Ър╕▒р╕Щр╕Чр╕╢р╕Б

### 1.2 р╕Чр╕Фр╕кр╕нр╕Ър╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ
1. р╣Ар╕ер╕╖р╕нр╕Бр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ `testFormSubmission` р╕Ир╕▓р╕Б dropdown
2. р╕Бр╕Ф **Run** (тЦ╢я╕П)
3. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ logs р╕зр╣Ир╕▓р╕бр╕╡ error р╕лр╕гр╕╖р╕нр╣Др╕бр╣И
4. р╕Цр╣Йр╕▓р╕Вр╕нр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╕Бр╕Ф **Review permissions** тЖТ **Allow**

### 1.3 Deploy р╣Гр╕лр╕бр╣И (р╕Цр╣Йр╕▓р╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ)
1. р╕Бр╕Ф **Deploy** тЖТ **Manage deployments**
2. р╕Бр╕Ф **тЬПя╕П Edit**
3. р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щ **Version** р╣Ар╕Ыр╣Зр╕Щ **New**
4. р╕Бр╕Ф **Deploy**

---

## ЁЯОп **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕Чр╕Фр╕кр╕нр╕Ър╕Фр╣Йр╕зр╕в Simple Form**

### 2.1 р╣Ар╕Ыр╕┤р╕Ф Simple Test
```bash
cd /Users/techit/Desktop/Code/Certificate_auto
python -m http.server 8000
```

### 2.2 р╕Чр╕Фр╕кр╕нр╕Ър╕Яр╕нр╕гр╣Мр╕бр╕Зр╣Ир╕▓р╕в
1. р╣Ар╕Ыр╕┤р╕Ф: **http://localhost:8000/simple_test.html**
2. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕е:
   - First Name: `Test`
   - Last Name: `User`
   - Email: р╕нр╕╡р╣Ар╕бр╕ер╕Ир╕гр╕┤р╕Зр╕Вр╕нр╕Зр╕Др╕╕р╕У
   - Grade: `M1`
   - р╕Ыр╕ер╣Ир╕нр╕вр╕Др╣Ир╕▓ ratings р╣Ар╕Ыр╣Зр╕Щ default
3. р╕Бр╕Ф **"Submit Test"**

### 2.3 р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
**р╕Цр╣Йр╕▓р╕кр╕│р╣Ар╕гр╣Зр╕И:**
- тЬЕ Status р╣Бр╕кр╕Фр╕З "Submitted!"
- тЬЕ р╣Гр╕Щ Google Sheets р╕Ир╕░р╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣И
- тЬЕ р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М M1 р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕Зр╣Гр╕Щ Google Drive
- тЬЕ р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕нр╕╡р╣Ар╕бр╕ер╕ар╕▓р╕вр╣Гр╕Щ 5-10 р╕Щр╕▓р╕Чр╕╡

**р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕кр╕│р╣Ар╕гр╣Зр╕И:**
- р╕Бр╕Ф F12 р╕Фр╕╣ Console errors
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Google Apps Script Executions

---

## ЁЯОп **р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╣Бр╕Бр╣Йр╣Др╕В Main Form (р╕Цр╣Йр╕▓ Simple Test р╕кр╕│р╣Ар╕гр╣Зр╕И)**

### 3.1 р╣Бр╕Бр╣Йр╣Др╕В script.js
р╕Ыр╕▒р╕Нр╕лр╕▓р╕Др╕╖р╕н 403 Error р╣Бр╕ер╕░ ReferenceError р╣Бр╕ер╣Йр╕зр╣Бр╕Бр╣Йр╣Др╕Вр╣Бр╕ер╣Йр╕з

### 3.2 р╕Чр╕Фр╕кр╕нр╕Ъ Main Form
1. р╣Ар╕Ыр╕┤р╕Ф: **http://localhost:8000**
2. р╕Бр╕гр╕нр╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Др╕гр╕Ъ
3. р╕Бр╕Ф **"р╕кр╣Ир╕Зр╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щ"**

---

## ЁЯФН **р╕Бр╕▓р╕г Debug**

### Google Apps Script Logs
1. р╣Ар╕Ыр╕┤р╕Ф: https://script.google.com/d/AKfycbzGNFHGy8WBSbxZpxC_QWAyzCTjlnCCQsGItBIJk-f40k0jtsMx7nlteNr7WOUhQeOU/edit
2. р╕Др╕ер╕┤р╕Б **"Executions"** tab
3. р╕Фр╕╣ execution р╕ер╣Ир╕▓р╕кр╕╕р╕Ф

### Browser Console
```javascript
// р╣Ар╕Ыр╕┤р╕Ф F12 р╣Бр╕ер╕░р╕гр╕▒р╕Щр╣Гр╕Щ Console
console.log('Testing URL:', 'https://script.google.com/macros/s/AKfycbzGNFHGy8WBSbxZpxC_QWAyzCTjlnCCQsGItBIJk-f40k0jtsMx7nlteNr7WOUhQeOU/exec');

// р╕Чр╕Фр╕кр╕нр╕Ъ GET request
fetch('https://script.google.com/macros/s/AKfycbzGNFHGy8WBSbxZpxC_QWAyzCTjlnCCQsGItBIJk-f40k0jtsMx7nlteNr7WOUhQeOU/exec')
.then(r => r.text())
.then(data => console.log('Response:', data));
```

---

## ЁЯОп **Expected Results**

### тЬЕ Simple Test Success:
```
Google Sheets: р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Вр╣Йр╕▓р╣Др╕Ы
Google Drive: р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М M1/M2/M3 р╕Цр╕╣р╕Бр╕кр╕гр╣Йр╕▓р╕З
Email: р╣Др╕Фр╣Йр╕гр╕▒р╕Ър╣Гр╕Ър╕Ыр╕гр╕░р╕Бр╕▓р╕ир╕Щр╕╡р╕вр╕Ър╕▒р╕Хр╕г PDF
```

### тЬЕ Main Form Success:
```
Browser: р╣Бр╕кр╕Фр╕З "р╕кр╣Ир╕Зр╣Бр╕Ър╕Ър╕Ыр╕гр╕░р╣Ар╕бр╕┤р╕Щр╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з!"
No CORS errors
No JavaScript errors
```

---

## ЁЯЪи **Common Issues & Solutions**

### Issue 1: 403 Error
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: Google Apps Script р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕лр╕гр╕╖р╕н Deploy р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**: 
- р╕гр╕▒р╕Щр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ `testFormSubmission` р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣М
- Deploy р╣Гр╕лр╕бр╣Ир╣Ар╕Ыр╣Зр╕Щ Web App

### Issue 2: р╣Др╕бр╣Ир╕бр╕╡р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Google Sheets
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: Spreadsheet ID р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕лр╕гр╕╖р╕нр╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣М
**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `SPREADSHEET_ID` р╣Гр╕Щ Google Apps Script
- р╣Гр╕лр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣М Google Sheets API

### Issue 3: р╣Др╕бр╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╕нр╕╡р╣Ар╕бр╕е
**р╕кр╕▓р╣Ар╕лр╕Хр╕╕**: Gmail API р╣Др╕бр╣Ир╕бр╕╡р╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕лр╕гр╕╖р╕н Template р╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
**р╕зр╕┤р╕Шр╕╡р╣Бр╕Бр╣Й**:
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Spam folder
- р╣Гр╕лр╣Йр╕кр╕┤р╕Чр╕Шр╕┤р╣М Gmail API
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ `CERTIFICATE_TEMPLATE_ID`

---

## ЁЯПБ **р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в**

**р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕Чр╕Фр╕кр╕нр╕Ъ Step-by-Step р╣Бр╕ер╣Йр╕з:**
1. тЬЕ Simple Test р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й
2. тЬЕ Main Form р╕Чр╕│р╕Зр╕▓р╕Щр╣Др╕Фр╣Й  
3. тЬЕ р╣Др╕бр╣Ир╕бр╕╡ JavaScript errors
4. тЬЕ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Ар╕Вр╣Йр╕▓ Google Sheets
5. тЬЕ р╣Гр╕Ър╕Ыр╕гр╕░р╕Бр╕▓р╕ир╕Щр╕╡р╕вр╕Ър╕▒р╕Хр╕гр╕кр╣Ир╕Зр╕Чр╕▓р╕Зр╕нр╕╡р╣Ар╕бр╕е

**ЁЯОЙ р╕гр╕░р╕Ър╕Ър╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З!**